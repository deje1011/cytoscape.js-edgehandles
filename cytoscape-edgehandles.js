!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("lodash.memoize"),require("lodash.throttle")):"function"==typeof define&&define.amd?define(["lodash.memoize","lodash.throttle"],t):"object"==typeof exports?exports.cytoscapeEdgehandles=t(require("lodash.memoize"),require("lodash.throttle")):e.cytoscapeEdgehandles=t(e._.memoize,e._.throttle)}(this,function(e,t){return function(e){function t(n){if(i[n])return i[n].exports;var s=i[n]={i:n,l:!1,exports:{}};return e[n].call(s.exports,s,s.exports,t),s.l=!0,s.exports}var i={};return t.m=e,t.c=i,t.i=function(e){return e},t.d=function(e,i,n){t.o(e,i)||Object.defineProperty(e,i,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var i=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(i,"a",i),i},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=12)}([function(e,t,i){"use strict";e.exports=null!=Object.assign?Object.assign.bind(Object):function(e){for(var t=arguments.length,i=Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];return i.filter(function(e){return null!=e}).forEach(function(t){Object.keys(t).forEach(function(i){return e[i]=t[i]})}),e}},function(e,t,i){"use strict";var n=i(10),s=i(0);e.exports=function(e){return new n(s({cy:this},e))}},function(e,t,i){"use strict";function n(){if(this.saveGestureState(),this.cy.zoomingEnabled(!1).panningEnabled(!1).boxSelectionEnabled(!1),this.options.disableBrowserGestures){var e=this.windowListenerOptions;window.addEventListener("touchstart",this.preventDefault,e),window.addEventListener("touchmove",this.preventDefault,e),window.addEventListener("wheel",this.preventDefault,e)}return this}function s(){if(this.cy.zoomingEnabled(this.lastZoomingEnabled).panningEnabled(this.lastPanningEnabled).boxSelectionEnabled(this.lastBoxSelectionEnabled),this.options.disableBrowserGestures){var e=this.windowListenerOptions;window.removeEventListener("touchstart",this.preventDefault,e),window.removeEventListener("touchmove",this.preventDefault,e),window.removeEventListener("wheel",this.preventDefault,e)}return this}function o(){var e=this.cy;return this.lastPanningEnabled=e.panningEnabled(),this.lastZoomingEnabled=e.zoomingEnabled(),this.lastBoxSelectionEnabled=e.boxSelectionEnabled(),this}e.exports={disableGestures:n,resetGestures:s,saveGestureState:o}},function(e,t,i){"use strict";function n(){var e=this,t=this.cy,i=this.options;return this.addListener(t,"drag",function(){return e.grabbingNode=!0}),this.addListener(t,"free",function(){return e.grabbingNode=!1}),this.addListener(t,"mouseover","node",function(t){e.show(t.target)}),this.addListener(t,"tap","node",function(t){var i=t.target;i.same(e.handleNode)||e.show(i)}),this.addListener(t,"position","node",function(t){t.target.same(e.sourceNode)&&e.handleShown()&&(i.repositionHandleWhenNodeMoves?e.setHandleFor(e.sourceNode):e.hide())}),this.addListener(t,"tapstart","node",function(t){var i=t.target;i.same(e.handleNode)?e.start(e.sourceNode):e.drawMode?e.start(i):i.same(e.sourceNode)&&e.hide()}),this.addListener(t,"tapdrag",function(t){e.update(t.position)}),this.addListener(t,"tapdragover","node",function(t){i.snap||e.preview(t.target)}),this.addListener(t,"tapdragout","node",function(t){i.snap||e.unpreview(t.target)}),this.addListener(t,"tapend",function(){e.stop()}),this.addListener(t,"remove",function(t){t.target.same(e.sourceNode)&&e.hide()}),this}e.exports={addCytoscapeListeners:n}},function(e,t,i){"use strict";var n={preview:!0,hoverDelay:150,handleNodes:"node",snap:!1,snapThreshold:50,snapFrequency:15,noEdgeEventsInDraw:!1,disableBrowserGestures:!0,repositionHandleWhenNodeMoves:!1,handlePosition:function(e){return"middle top"},handleInDrawMode:!1,edgeType:function(e,t){return"flat"},loopAllowed:function(e){return!1},nodeLoopOffset:-50,nodeParams:function(e,t){return{}},edgeParams:function(e,t,i){return{}},ghostEdgeParams:function(){return{}},show:function(e){},hide:function(e){},start:function(e){},complete:function(e,t,i){},stop:function(e){},cancel:function(e,t){},hoverover:function(e,t){},hoverout:function(e,t){},previewon:function(e,t,i){},previewoff:function(e,t,i){},drawon:function(){},drawoff:function(){}};e.exports=n},function(e,t,i){"use strict";function n(e){var t=this.cy,i=this.options;return this.drawMode=null!=e?e:!this.drawMode,this.drawMode?(this.prevUngrabifyState=t.autoungrabify(),t.autoungrabify(!0),!i.handleInDrawMode&&this.handleShown()&&this.hide(),this.emit("drawon")):(t.autoungrabify(this.prevUngrabifyState),this.emit("drawoff")),this}function s(){return this.toggleDrawMode(!0)}function o(){return this.toggleDrawMode(!1)}e.exports={toggleDrawMode:n,enableDrawMode:s,disableDrawMode:o}},function(e,t,i){"use strict";function n(e,t,i){var n={};return p(n,t,e),p(n.data,t.data,e.data),v(t.classes)?n.classes=t.classes+" "+i:f(t.classes)?n.classes=t.classes.join(" ")+" "+i:n.classes=i,n}function s(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.cy,i=this.options,s=this.presumptiveTargets,o=this.previewEles,r=this.active,a=this.sourceNode,h=this.targetNode,d=e?"eh-preview":"",u=t.collection(),c=i.edgeType(a,h);if(r&&c&&(!e||i.preview)){if(!h||0===h.size())return o.remove(),void this.emit("cancel",this.mp(),a,s);if(!e&&i.preview)return o.removeClass("eh-preview").style("events",""),void this.emit("complete",this.mp(),a,h,o);var l=a.position(),p=h.position(),v=void 0;if(v=a.same(h)?{x:l.x+i.nodeLoopOffset,y:l.y+i.nodeLoopOffset}:{x:(l.x+p.x)/2,y:(l.y+p.y)/2},"node"===c){var f=t.add(n({group:"nodes",position:v},i.nodeParams(a,h),d)),m=t.add(n({group:"edges",data:{source:a.id(),target:f.id()}},i.edgeParams(a,h,0),d)),g=t.add(n({group:"edges",data:{source:f.id(),target:h.id()}},i.edgeParams(a,h,1),d));u=u.merge(f).merge(m).merge(g)}else{var y=t.add(n({group:"edges",data:{source:a.id(),target:h.id()}},i.edgeParams(a,h,0),d));u=u.merge(y)}return e?(this.previewEles=u,u.style("events","no")):(u.style("events",""),this.emit("complete",this.mp(),a,h,u)),this}}function o(){return this.makeEdges(!0),this}function r(){return this.previewEles.nonempty()&&this.previewEles.inside()}function a(){return this.previewShown()&&this.previewEles.remove(),this}function h(){return this.handleNode.nonempty()&&this.handleNode.inside()}function d(){return this.handleShown()&&this.handleNode.remove(),this}function u(e){var t=this,i=this.options,n=this.cy,s=l(i.handlePosition)===l("")?function(){return i.handlePosition}:i.handlePosition,o=e.position(),r=e.outerHeight(),a=e.outerWidth(),h=0,d=0,u=s(e).toLowerCase().split(/\s+/),c=u[0],p=u[1];"left"===c?h=-a/2:"right"===c&&(h=a/2),"top"===p?d=-r/2:"bottom"===p&&(d=r/2);var v=this.hx=o.x+h,f=this.hy=o.y+d,m={x:v,y:f};return this.handleShown()?this.handleNode.position(m):n.batch(function(){t.handleNode=n.add({classes:"eh-handle",position:m,grabbable:!1,selectable:!1}),t.handleNode.style("z-index",9007199254740991)}),this}function c(){var e=this,t=this.sourceNode,i=this.ghostNode,n=this.cy,s=this.mx,o=this.my,r=this.options,a=s,h=o,d=void 0,u=void 0;if(t)return i&&0!==i.length&&!i.removed()||(u=this.ghostEles=n.collection(),n.batch(function(){i=e.ghostNode=n.add({group:"nodes",classes:"eh-ghost eh-ghost-node",position:{x:0,y:0}}),i.style({"background-color":"blue",width:1e-4,height:1e-4,opacity:0,events:"no"});var s=r.ghostEdgeParams();d=n.add(p({},s,{group:"edges",data:p({},s.data,{source:t.id(),target:i.id()}),classes:"eh-ghost eh-ghost-edge"})),d.style({events:"no"})}),u.merge(i).merge(d)),i.position({x:a,y:h}),this}var l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},p=i(0),v=function(e){return(void 0===e?"undefined":l(e))===l("")},f=function(e){return(void 0===e?"undefined":l(e))===l([])&&null!=e.length};e.exports={makeEdges:s,makePreview:o,removePreview:a,previewShown:r,updateEdge:c,handleShown:h,setHandleFor:u,removeHandle:d}},function(e,t,i){"use strict";function n(){return this.options.noEdgeEventsInDraw&&this.cy.edges().style("events","no"),this}function s(){return this.options.noEdgeEventsInDraw&&this.cy.edges().style("events",""),this}e.exports={disableEdgeEvents:n,enableEdgeEvents:s}},function(e,t,i){"use strict";function n(){return this.enabled=!0,this.emit("enable"),this}function s(){return this.enabled=!1,this.emit("disable"),this}e.exports={enable:n,disable:s}},function(e,t,i){"use strict";function n(e){var t=this.options,i=this.previewEles,n=this.ghostEles,s=this.handleNode,o=function(e){return i.anySame(e)},r=function(e){return n.anySame(e)},a=function(e){return s.same(e)},h=this.enabled,d=this.active,u=this.grabbingNode;return h&&!d&&!u&&(null==e||!function(e){return o(e)||a(e)||r(e)}(e)&&function(e){return e.filter(t.handleNodes).length>0}(e))}function s(e){return this.canStartOn(e)&&this.drawMode}function o(e){return this.canStartOn(e)&&!this.drawMode}function r(e){var t=this.options,i=this.drawMode;if(this.canStartOn(e)&&(!i||t.handleInDrawMode))return this.sourceNode=e,this.setHandleFor(e),this.emit("show",this.hp(),this.sourceNode),this}function a(){return this.removeHandle(),this.emit("hide",this.hp(),this.sourceNode),this}function h(e){this.canStartOn(e)&&(this.active=!0,this.sourceNode=e,this.sourceNode.addClass("eh-source"),this.disableGestures(),this.disableEdgeEvents(),this.emit("start",this.hp(),e))}function d(e){if(this.active){var t=e;return this.mx=t.x,this.my=t.y,this.updateEdge(),this.throttledSnap(),this}}function u(){if(!this.active||!this.options.snap)return!1;var e=this.cy,t=this.targetNode,i=this.options.snapThreshold,n=this.mp(),s=this.handleNode,o=this.previewEles,r=this.ghostNode,a=function(e){return v*Math.max(e.outerWidth(),e.outerHeight())/2},h=function(e,t,i,n){var s=i-e,o=n-t;return s*s+o*o},d=function(e,t){return h(e.x,e.y,t.x,t.y)},u=function(e){return d(e.position(),n)},c=function(e){var t=a(e),n=t+i;return n*n},l=function(e){return u(e)<=c(e)},p=function(e){var t=e.position(),i=e.outerWidth()/2,s=e.outerHeight()/2,o=t.x,r=t.y,a=n.x,d=n.y,u=o-i,c=o+i,l=r-s,p=r+s,v=u<=a&&a<=c,f=l<=d&&d<=p;if(v&&f)return 0;if(v){var m=d-l,g=d-p;return Math.min(m*m,g*g)}if(f){var y=a-u,w=a-c;return Math.min(y*y,w*w)}return a<u&&d<l?h(a,d,u,l):a>c&&d<l?h(a,d,c,l):a<u&&d>p?h(a,d,u,p):h(a,d,c,p)},f=function(e,t){return p(e)-p(t)},m=f,g=function(e){var t=n,i=e.outerWidth(),s=i/2,o=e.outerHeight(),r=o/2,a=e.position(),h=a.x-s,d=a.x+s,u=a.y-r,c=a.y+r;return h<=t.x&&t.x<=d&&u<=t.y&&t.y<=c},y=function(e){return e.same(s)||e.same(o)||e.same(r)},w=e.nodes(function(e){return!y(e)&&l(e)}).sort(m),b=!1;t.nonempty()&&!l(t)&&this.unpreview(t);for(var E=0;E<w.length;E++){var x=w[E];if((!x.isParent()||!g(x))&&((!x.isChild()||g(x.parent()))&&(x.same(t)||this.preview(x,!1)))){b=!0;break}}return b}function c(e){var t=this,i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.options,s=this.sourceNode,o=this.ghostNode,r=this.ghostEles,a=this.presumptiveTargets,h=this.previewEles,d=this.active,u=s,c=e.same(u),l=n.loopAllowed(e),p=e.same(o),v=!n.edgeType(u,e),f=e.same(this.handleNode),m=e.same(this.targetNode);if(!d||f||p||v||m||c&&!l)return!1;this.targetNode.nonempty()&&this.unpreview(this.targetNode),clearTimeout(this.previewTimeout);var g=function(){t.targetNode=e,a.merge(e),e.addClass("eh-presumptive-target"),e.addClass("eh-target"),t.emit("hoverover",t.mp(),u,e),n.preview&&(e.addClass("eh-preview"),r.addClass("eh-preview-active"),s.addClass("eh-preview-active"),e.addClass("eh-preview-active"),t.makePreview(),t.emit("previewon",t.mp(),u,e,h))};return i&&n.hoverDelay>0?this.previewTimeout=setTimeout(g,n.hoverDelay):g(),!0}function l(e){if(this.active&&!e.same(this.handleNode)){var t=this.previewTimeout,i=this.sourceNode,n=this.previewEles,s=this.ghostEles,o=this.cy;clearTimeout(t),this.previewTimeout=null;var r=i;return e.removeClass("eh-preview eh-target eh-presumptive-target eh-preview-active"),s.removeClass("eh-preview-active"),i.removeClass("eh-preview-active"),this.targetNode=o.collection(),this.removePreview(r,e),this.emit("hoverout",this.mp(),r,e),this.emit("previewoff",this.mp(),r,e,n),this}}function p(){if(this.active){var e=this.sourceNode,t=this.targetNode,i=this.ghostEles,n=this.presumptiveTargets;return clearTimeout(this.previewTimeout),e.removeClass("eh-source eh-preview-active"),t.removeClass("eh-target eh-preview eh-hover eh-preview-active"),n.removeClass("eh-presumptive-target"),this.makeEdges(),this.removeHandle(),i.remove(),this.clearCollections(),this.resetGestures(),this.enableEdgeEvents(),this.active=!1,this.emit("stop",this.mp(),e),this}}var v=(i(13),Math.sqrt(2));e.exports={show:r,hide:a,start:h,update:d,preview:c,unpreview:l,stop:p,snap:u,canStartOn:n,canStartDrawModeOn:s,canStartNonDrawModeOn:o}},function(e,t,i){"use strict";function n(e){var t=e.cy;this.cy=t,this.listeners=[],this.enabled=!0,this.drawMode=!1,this.active=!1,this.grabbingNode=!1,this.handleNode=t.collection(),this.clearCollections(),this.hx=0,this.hy=0,this.hr=0,this.mx=0,this.my=0,this.options=o({},s,e),this.saveGestureState(),this.addListeners(),this.throttledSnap=r(this.snap.bind(this),1e3/e.snapFrequency),this.preventDefault=function(e){return e.preventDefault()};var i=!1;try{var n=Object.defineProperty({},"passive",{get:function(){i=!0}});window.addEventListener("test",null,n)}catch(e){}this.windowListenerOptions=!i||{capture:!0,passive:!1}}var s=i(4),o=i(0),r=i(14),a=i(2),h=i(3),d=i(5),u=i(6),c=i(8),l=i(9),p=i(11),v=i(7),f=n.prototype={},m=function(e){return o(f,e)};f.destroy=function(){this.removeListeners()},f.setOptions=function(e){o(this.options,e)},f.mp=function(){return{x:this.mx,y:this.my}},f.hp=function(){return{x:this.hx,y:this.hy}},f.clearCollections=function(){var e=this.cy;this.previewEles=e.collection(),this.ghostEles=e.collection(),this.ghostNode=e.collection(),this.sourceNode=e.collection(),this.targetNode=e.collection(),this.presumptiveTargets=e.collection()},[a,h,d,u,c,l,p,v].forEach(m),e.exports=n},function(e,t,i){"use strict";function n(){var e=this;return this.addCytoscapeListeners(),this.addListener(this.cy,"destroy",function(){return e.destroy()}),this}function s(){for(var e=this.listeners.length-1;e>=0;e--){var t=this.listeners[e];this.removeListener(t.target,t.event,t.selector,t.callback,t.options)}return this}function o(e,t,i,n,s){return(void 0===i?"undefined":u(i))!==u("")&&(n=i,s=n,i=null),null==s&&(s=!1),{target:e,event:t,selector:i,callback:n,options:s}}function r(e){return e instanceof Element}function a(e,t,i,n,s){var a=o(e,t,i,n,s);return this.listeners.push(a),r(a.target)?a.target.addEventListener(a.event,a.callback,a.options):a.selector?a.target.addListener(a.event,a.selector,a.callback,a.options):a.target.addListener(a.event,a.callback,a.options),this}function h(e,t,i,n,s){for(var a=o(e,t,i,n,s),h=this.listeners.length-1;h>=0;h--){var d=this.listeners[h];if(!(a.target!==d.target||a.event!==d.event||null!=a.selector&&a.selector!==d.selector||null!=a.callback&&a.callback!==d.callback)){this.listeners.splice(h,1),r(a.target)?a.target.removeEventListener(a.event,a.callback,a.options):a.selector?a.target.removeListener(a.event,a.selector,a.callback,a.options):a.target.removeListener(a.event,a.callback,a.options);break}}return this}function d(e,t){for(var i=this.options,n=this.cy,s=arguments.length,o=Array(s>2?s-2:0),r=2;r<s;r++)o[r-2]=arguments[r];n.emit({type:"eh"+e,position:t},o);var a=i[e];return null!=a&&a.apply(void 0,o),this}var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};e.exports={addListener:a,addListeners:n,removeListener:h,removeListeners:s,emit:d}},function(e,t,i){"use strict";var n=i(1),s=function(e){e&&e("core","edgehandles",n)};"undefined"!=typeof cytoscape&&s(cytoscape),e.exports=s},function(t,i){t.exports=e},function(e,i){e.exports=t}])});